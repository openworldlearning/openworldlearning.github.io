

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Numerical integration &#8212; Open World Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/numerical_calculus/numerical_integration';</script>
    <link rel="shortcut icon" href="https://raw.githubusercontent.com/openworldlearning/openworldlearning.github.io/main/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Numerical calculus" href="../numerical_calculus.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/owl_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/owl_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    What is Open World Learning?
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../developers.html">Developers</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../internals/getting_started.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../internals/workflow.html">Development workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/conventions.html">Conventions</a></li>



<li class="toctree-l2"><a class="reference internal" href="../internals/writing.html">Writing for students</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/literature.html">Literature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/markdown.html">Writing and styling documents and notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/github.html">Github</a></li>

<li class="toctree-l2"><a class="reference internal" href="../internals/github_uio.html">Github at the University</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../software/software.html">Software tailored for learning</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../software/gpr/AI_in_the_lab.html">AI in the lab with btjenesten.gpr</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../software/gpr/polynomial_regression.html">Polynomial regression and its restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/gpr/GPR_intro.html">An introduction to Gaussian process regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/gpr/Covariance.html">Covariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/gpr/Kernels.html">Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software/gpr/quick_gpr_tutorial.html">Quick tutorial on the Gaussian process regression module from btjenesten</a></li>





</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software/bubblebox/mdbox_tutorial.html">Molecular dynamics with BubbleBox.mdbox</a></li>

<li class="toctree-l2 has-children"><a class="reference internal" href="../software/braketlab/braketlab.html">Quantum mechanics with BraketLab</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../general_chemistry.html">General chemistry</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../thermpaths.html">Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../thermodynamics/KE_to_Temp_math.html">How is <span class="math notranslate nohighlight">\(K_E =  \frac{3}{2} k_BT\)</span> for gas?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thermodynamics/KE_to_Temp_math_final.html">How does temperature relate to kinetic energy in gases?</a></li>







</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../qmpaths.html">Basic quantum mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/Quantum_thinking.html">How to think inside of the quantum world!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/linear_combinations.html">Dirac notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/Classical%20hydrogen.html">Limitations of classical mechanics in chemistry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/doubleslit.html">A double slit experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/schrodinger_equation.html">An encounter with the Schrödinger equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/numeric_schrodinger_1d.html">Solving the Schrodinger equation numerically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/eigenfunctions_eigenstates.html">Eigenfunctions and eigenstates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quantum_mechanics/hybridization.html">What is hybridization?</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../experimental_paths.html">Bringing theory and experiment closer with computers</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../experiment/experimental_data.html">Treating experimental data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../experiment/Implementing%20AI%20in%20a%20Lab%20Setting.html">Treating experimental data</a></li>






</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../numerical_calculus.html">Numerical calculus</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Numerical integration</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/openworldlearning/openworldlearning.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/openworldlearning/openworldlearning.github.io/issues/new?title=Issue%20on%20page%20%2Fdocs/numerical_calculus/numerical_integration.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/numerical_calculus/numerical_integration.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Numerical integration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-integral-really">What is the integral, really?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rectangle-methods">Rectangle methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-the-rectangle-methods">Implementing the rectangle methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-trapezoidal-rule">The Trapezoidal rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpson-s-method">Simpson’s method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-libraries-to-compute-integrals">Using libraries to compute integrals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-integration">Multiple integration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-integration">Symbolic integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concluding-remarks">Concluding remarks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videos">Videos</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="numerical-integration">
<h1>Numerical integration<a class="headerlink" href="#numerical-integration" title="Permalink to this heading">#</a></h1>
<p>There are many applications of integration in chemistry. Integration is used for everything from calculating molecular geometry in quantum chemistry to finding the area of a peak in an NMR spectrum or a chromatogram to find the concentration of analytes. In addition, we need to integrate to solve differential equations, which are really important in physical chemistry and quantum chemistry. You should therefore have a good grasp at what the integral means, what we get by integrating, as well as methods of calculating integrals. Let’s prepare you for exactly that!</p>
<section id="what-is-the-integral-really">
<h2>What is the integral, really?<a class="headerlink" href="#what-is-the-integral-really" title="Permalink to this heading">#</a></h2>
<p>Historically, integration is a way of calculating areas and volumes. Today, we use integrals for a lot of different things, but in many cases, it is useful to think of the integral as a sum of small pieces. The integral sign ∫ is in fact an elongated <em>S</em>, which means sum. In ancient Greek, over 1500 years before calculus was invented by Newton and Leibniz, the greek mathematicians calculated areas of geometric figures by partitioning them into smaller areas, often rectangles, and summing up the areas of all the smaller areas. This was an inefficient way of computing areas and volumes, since we need a lot of small areas to get a good approximation. Then came calculus, the study of infinitesimals and continous change.</p>
<p>With calculus (about 1700) came rigorous mathematical theorems and integration rules which you have learned to use in high school. This lets us compute integrals quickly (sometimes!) and exact. We call this <em>analytical integration</em>. Perhaps the most powerful result in calculus is the <em>fundamental theorem of calculus</em> (sounds important, right?!). This states that integration is the reverse of differentiating (taking the derivative):</p>
<div class="admonition-fundamental-theorem-of-calculus admonition">
<p class="admonition-title">Fundamental theorem of calculus</p>
<p>Let <em>f</em> be a continous function in the interval [a,b], and <em>F</em> be a function defined for <em>x</em> in [a,b]. That is</p>
<div class="math notranslate nohighlight">
\[F(x) = \int_a^x f(t) dt\]</div>
<p>then we have</p>
<div class="math notranslate nohighlight">
\[F'(x) = f(x)\]</div>
<p>Essentially, this means that the integral of a function is equal to the antiderivative to the function.</p>
</div>
<p>Calculus is a very important tool, but there are especially two caveats to using a set of rules to compute integrals:</p>
<ul class="simple">
<li><p>Not all integrals can be solved analytically.</p></li>
<li><p>When using rules, you might forget what you are actually doing, that is, what the integral really means.</p></li>
</ul>
<p>Do you sometimes feel that you get in a “plug-and-chug” mode, where you apply integration rules and do a lot of algebra, get the right result, but do not really understand what is going on? You are not alone. When the ancient greeks used sums of small parts, they used what we now know as the definition of the integral to approximate areas and volumes. They couldn’t have forgot what the integral meant in the process, since they kind of worked with the very definition of it. Couldn’t we use the same technique today? Yes, of course. But wasn’t it quite tedious to do all these calculations? Well, now we have another tool at our disposal: the computer. Summing thousands of areas is now done in a fraction of a second, greatly outperforming the ancient greeks. So let us get into the mindset of an ancient g(r)eek and start integrating!</p>
<div class="hint admonition">
<p class="admonition-title">Exercise</p>
<p>By using the concept of the integral as a sum of very small parts, interpret what the following integral, which describes the total distance (<em>s</em>) traveled by a particle following the velocity described by the function <span class="math notranslate nohighlight">\(v(t)\)</span> from the start time <span class="math notranslate nohighlight">\(t_0\)</span> to the end time <span class="math notranslate nohighlight">\(t_n\)</span>.</p>
<div class="math notranslate nohighlight">
\[s = \int_{t_0}^{t_n} v(t) dt\]</div>
</div>
<div class="hint dropdown admonition">
<p class="admonition-title">Proposed solution</p>
<p>The integral may be interpreted as follows: the distance traveled by the particle can be calculated by taking its speed <span class="math notranslate nohighlight">\(v_t\)</span> at every time <span class="math notranslate nohighlight">\(t\)</span> and multiply it by the timestep <span class="math notranslate nohighlight">\(dt\)</span>. Since we assume that we do this for an infinite amount of velocities, we know that the velocity is constant at every timestep. In principle, what we do is to calculate the distance with the relation <span class="math notranslate nohighlight">\(s = v\cdot t\)</span> for every time value, and then summing them all up. We can think of the integral as a limit of sums:</p>
<div class="math notranslate nohighlight">
\[s = \int_{t_0}^{t_f} v(t) dt = \lim_{n\rightarrow \infty} \sum_{i=0}^{n} v_i \cdot \Delta t\]</div>
<p>or equivalent:</p>
<div class="math notranslate nohighlight">
\[s = \lim_{\Delta t\rightarrow 0} \sum_{i=0}^{n} v_i \cdot \Delta t\]</div>
</div>
</section>
<section id="rectangle-methods">
<h2>Rectangle methods<a class="headerlink" href="#rectangle-methods" title="Permalink to this heading">#</a></h2>
<p>Let us take a look at how we can approximate an integral as a sum of geometric figures, like the ancient greeks did.  The simplest way of doing this, is by using rectangles:</p>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder/rektangel10_utentall.png?raw=true" width="500"/>
<p>Here, we use <span class="math notranslate nohighlight">\(N = 10\)</span> rectangles to approximate the integral <span class="math notranslate nohighlight">\(f(x) = \cos{(x)} + 2\)</span> for <span class="math notranslate nohighlight">\(x\in[2,12]\)</span>. The width of all rectangles is then <span class="math notranslate nohighlight">\((b-a)/N = (12-2)/10 = 1\)</span>. We can also see that the height of each rectangle is <span class="math notranslate nohighlight">\(f(x_n)\)</span>, with <span class="math notranslate nohighlight">\(n\in[2,11]\)</span>, that is, we only let the left side of the rectangle reach the function graph. If we calculate the sum of the areas of every rectangle, we get <em>A</em> = 18.046675645664006. This is a crude approximation to the analytical value (<span class="math notranslate nohighlight">\((\sin{(12)} + 2\cdot 12)-(\sin{(2)} + 2\cdot 2) \approx 18.554129655173885\)</span>. But if we increase the number of rectangles, for example to 50, we get a better approximation:</p>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/rectangle_left_50.png?raw=true" width="500"/>
<p>It is obvious, especially in the first figure, that several areas of the rectangles lie outside the graph. They are both too far above and below the graph in several places. But the error is not as big as it might seem because we just have areas both above and below the graph. The relative error here is approximately 2.7 % with 10 rectangles and 0.65 % with 50 rectangles.</p>
<p>Let us illustrate the error with a linear function <span class="math notranslate nohighlight">\(f(x) = 10x\)</span>:</p>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/rectangle_left_10.png?raw=true" width="500"/>
<p>In these models, we have measured the rectangle height on the left outer edge of the rectangle. In this instance, this gives us an underestimation of the exact area for each rectangle. We can also measure the height of the rectangles on the right edge. We then get a corresponding overestimation with this function:</p>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/rectangle_right_10.png?raw=true" width="500"/>
<p>We see here that we get a large underestimation with the left edge approximation and a large overestimation with the right edge approximation, with a relative error of approx. 7.1 %. The same happens for all functions in intervals that are either increasing or decreasing throughout the whole interval. One way to compensate for this is to use the height of the rectangles in the middle instead of the end point on the left or right:</p>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/rectangle_mid_10.png?raw=true" width="500"/>
<p>The best approximation using rectangles is therefore attained with the <em>midpoint method</em>. For linear functions, we will actually get an exact value (even with one rectangle!) because the error of the rectangles are the same size above and below the function. But the midpoint approximation gives great results with other functions as well. Methods like these were used by the ancient Greeks, but they did not have a computer at their disposal! So, let’s take a look at how we can implement these methods in Python.</p>
</section>
<section id="implementing-the-rectangle-methods">
<h2>Implementing the rectangle methods<a class="headerlink" href="#implementing-the-rectangle-methods" title="Permalink to this heading">#</a></h2>
<div class="admonition-rectangle-method-left-corner-approach admonition">
<p class="admonition-title">Rectangle method (left corner approach)</p>
<p>The definite integral of a function <span class="math notranslate nohighlight">\(f(x)\)</span> from <span class="math notranslate nohighlight">\(x = a\)</span> to <span class="math notranslate nohighlight">\(x = b\)</span> can be approximated by the area of <span class="math notranslate nohighlight">\(n\)</span> rectangles with width <span class="math notranslate nohighlight">\(h = \frac{b-a}{n}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) \ \mathrm{d}x \approx h \sum_{k=1}^{n} f(x_k)\]</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise</p>
<p>The program below shows a function which uses the left corner approach of the rectangle rule to approximate the definite integral of a function <em>f</em> between <em>a</em> and <em>b</em>. Fill inn the lines that are missing in the code.</p>
</div>
<iframe src="https://trinket.io/embed/python3/2b6f883886" width="100%" height="600" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe>
<div class="tip dropdown admonition">
<p class="admonition-title">Proposed solution</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>				<span class="c1">#Defining a function to integrate</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
    
<span class="k">def</span> <span class="nf">f_analytical</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>    <span class="c1">#Defining an analytical value to evaluate the method</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span>

<span class="k">def</span> <span class="nf">rectangle_rule_left</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.0</span>							   
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>			<span class="c1"># width of rectangles</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>	
        <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">h</span>
    <span class="k">return</span> <span class="n">A</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numerical value:&quot;</span><span class="p">,</span> <span class="n">rectangle_rule_left</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analytical value:&quot;</span><span class="p">,</span> <span class="n">f_analytical</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="n">f_analytical</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Similarly, we can describe the right-hand approximation as follows:</p>
<div class="admonition-rectangle-method-right-corner-approach admonition">
<p class="admonition-title">Rectangle method (right corner approach)</p>
<p>The definite integral of a function <span class="math notranslate nohighlight">\(f(x)\)</span> from <span class="math notranslate nohighlight">\(x = a\)</span> to <span class="math notranslate nohighlight">\(x = b\)</span> can be approximated by the area of <span class="math notranslate nohighlight">\(n\)</span> rectangles with width <span class="math notranslate nohighlight">\(h = \frac{b-a}{n}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) \ \mathrm{d}x \approx h \sum_{k=1}^{n} f(x_{k+1})\]</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise</p>
<p>Implement the algorithm for the right corner approach as a Python function. Test and compare with the left corner approach on the integral <span class="math notranslate nohighlight">\(\int_2^8 f(x) = x^2 - 2x + 4 \ dx\)</span>.</p>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Proposed solution</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rectangle_rule_right</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.0</span>							   
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>	
        <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">h</span>
    <span class="k">return</span> <span class="n">A</span>
</pre></div>
</div>
</div>
<p>We get the best approximation by combining the left and right corner approach, which gives us the midpoint approximation:</p>
<div class="admonition-rectangle-method-midpoint-approach admonition">
<p class="admonition-title">Rectangle method (midpoint approach)</p>
<p>The definite integral of a function <span class="math notranslate nohighlight">\(f(x)\)</span> from <span class="math notranslate nohighlight">\(x = a\)</span> to <span class="math notranslate nohighlight">\(x = b\)</span> can be approximated by the area of <span class="math notranslate nohighlight">\(n\)</span> rectangles with width <span class="math notranslate nohighlight">\(h = \frac{b-a}{n}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) \ \mathrm{d}x \approx h \sum_{k=1}^{n} f\left(\frac{1}{2}(x_k + x_{k+1})\right)\]</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise</p>
<p>Implement the algorithm for the right corner approach as a Python function. Test and compare with the left and right corner approach on the integral <span class="math notranslate nohighlight">\(\int_2^8 f(x) = x^2 - 2x + 4 \ dx\)</span>.</p>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Proposed solution</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rectangle_rule_midpointf</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.0</span>							   
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">n</span><span class="p">):</span>	
        <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">h</span>
    <span class="k">return</span> <span class="n">A</span>
</pre></div>
</div>
</div>
<p>If we need to integrate functions with very high or low slopes (<span class="math notranslate nohighlight">\(|f'(x) &gt;&gt; 0|\)</span>), we will need many rectangles to get a satisfactory result. And even with many rectangles, the approximation is not as good as with other methods. Let us therefore take a look at more advanced and improved methods of calculating an integral.</p>
</section>
<section id="the-trapezoidal-rule">
<h2>The Trapezoidal rule<a class="headerlink" href="#the-trapezoidal-rule" title="Permalink to this heading">#</a></h2>
<p>No, it’s not a trap. We can do better than rectangles. We know that the the top part of a rectangle is a straight, horizontal line. Such a line can be represented as a polynomial of degree zero, <span class="math notranslate nohighlight">\(f(x) = ax^0 = a\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is a real number. Let’s look at the possibility of replacing this top part with a polynomial of the first degree, <span class="math notranslate nohighlight">\(f(x) = ax^1 = ax\)</span>. Then we get <em>trapezoids</em> instead of rectangles. An algorithm for this is a bit less intuitive and a bit more strenous to derive, but we’ll give it a go. Let’s start with the trapezoidal method illustrated with one trapezoid in the interval <span class="math notranslate nohighlight">\([a, b] = [2, 12]\)</span> with <span class="math notranslate nohighlight">\(f(x) = \cos(x) + 2\)</span>:</p>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/trapezoid_1.png?raw=true" width="500"/>
<p>Let us derive an algorithm for the trapezoidal rule. Let’s start with the are of a trapezoid:</p>
<div class="math notranslate nohighlight">
\[A_{trapezoid} = \frac{x_1 + x_2}{2}\cdot h\]</div>
<p>The two sides of the trapezoid, <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span>, can here be expressed as <span class="math notranslate nohighlight">\(f(a)\)</span> and <span class="math notranslate nohighlight">\(f(b)\)</span> respectively. The height of the trapezoid is <span class="math notranslate nohighlight">\(b-a\)</span> (flip the screen to the left if you don’t like that the height is where we said it is). The area can then be expressed as:</p>
<div class="math notranslate nohighlight">
\[A = \frac{f(a) + f(b)}{2}\cdot(b-a)\]</div>
<p>Let us now expand this to <span class="math notranslate nohighlight">\(n\)</span> trapezoids. The heigh of every trapezoid is then <span class="math notranslate nohighlight">\(h = (x_1+x_2)/n\)</span>, which gives us this expression for the area of every <span class="math notranslate nohighlight">\(i\)</span>-th trapezoid:</p>
<div class="math notranslate nohighlight">
\[A_i = \frac{f(x_i) + f(x_i)}{2}\cdot h\]</div>
<p>If we sum the are of all <span class="math notranslate nohighlight">\(n\)</span> trapezoids, we get:</p>
<div class="math notranslate nohighlight">
\[\frac{f(a)+f(a+h)}{2}h + \frac{f(a+h)+f(a+2h)}{2}h + \frac{f(a+2h)+f(a+3h)}{2}h + ... + \frac{f(a+ih)+f(b)}{2}h\]</div>
<p>This seems a bit too long and complicated. Let’s simplify it. First of all, we can multiplicate every term with <span class="math notranslate nohighlight">\(h\)</span> and divide them by 2:</p>
<div class="math notranslate nohighlight">
\[\frac{h}{2}\cdot (f(a)+f(a+h)+f(a+h)+f(a+2h)+f(a+2h)+ ... + f(a+ih) + f(b))\]</div>
<p>If we add terms that are the same, we get:</p>
<div class="math notranslate nohighlight">
\[\frac{h}{2}\cdot (f(a)+2f(a+h)+2f(a+2h)+2f(a+3h)+ ... + 2f(a+ih) + f(b))\]</div>
<p>Since <span class="math notranslate nohighlight">\(f(a)\)</span> and <span class="math notranslate nohighlight">\(f(b)\)</span> are the only terms not multiplied by 2, we can simplify further:</p>
<div class="math notranslate nohighlight">
\[h\left(\frac{f(a)+f(b)}{2} + (f(a+h)+f(a+2h)+f(a+3h)+ ... + f(a+ih))\right)\]</div>
<p>The last collection of terms we can write as a sum. Then we get the trapezoidal rule:</p>
<div class="admonition-trapezoidal-rule admonition">
<p class="admonition-title">Trapezoidal rule</p>
<p>The definite integral of a function <span class="math notranslate nohighlight">\(f(x)\)</span> from <span class="math notranslate nohighlight">\(x = a\)</span> to <span class="math notranslate nohighlight">\(x = b\)</span> can be approximated by the sum of the area of <span class="math notranslate nohighlight">\(n\)</span> trapezoids with the width <span class="math notranslate nohighlight">\(h = \frac{b-a}{n}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) dx \approx h\left( \frac{f(a)+f(b)}{2} + \sum_{i=1}^{n-1} f(x_i) \right)\]</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise</p>
<p>Implement the trapezoidal rule and test it on the functions <span class="math notranslate nohighlight">\(f(x) = x^3 + 2x\)</span> and <span class="math notranslate nohighlight">\(f(x) = \sqrt(x)\)</span> in the interval <span class="math notranslate nohighlight">\([2,4]\)</span>. Compare the result with the rectangle rule(s) with the same <span class="math notranslate nohighlight">\(n\)</span>.</p>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Proposed solution</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">trapezoidal_rule</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">h</span>
</pre></div>
</div>
</div>
<p>Naturally, as we increase the number of trapezoids, we get an even better approximation:</p>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/trapezoid_10.png?raw=true" width="500"/>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/trapezoid_50.png?raw=true" width="500"/>
<p>Even though the trapezoidal rule is a general improvement of the rectangle rule, in most cases, we get more precise results with the midpoint rectangle rule than with the trapezoidal rule! Nevertheless, we used the trapezoidal rule to illustrate that we can increase the degree of the polynomial representing the “top part” of the geometric figures we use to split up and calculate the area. This can be generalized such that we can use any polynomial as the top part, improving our approximations further. We can use interpolation to derive such methods, but we will no</p>
<p>Increasing the polynomial degree comes at a cost, though. When we use a polynomial of a degree higher than 1, we need to find the function values of that polynomial in more than 2 points. This implies increased computing time. Therefore, we need to balance computational cost against how precise the method is. One great method in this regard, is Simpson’s method.</p>
</section>
<section id="simpson-s-method">
<h2>Simpson’s method<a class="headerlink" href="#simpson-s-method" title="Permalink to this heading">#</a></h2>
<p>Simpson’s method is an integration method using polynomials of degree 2 to approximate integrals. We will not derive the method here, but we will implement it and test it out. The main thing you need to understand is that the differe</p>
<div class="admonition-simpsons-metode admonition">
<p class="admonition-title">Simpsons metode</p>
<p>The definite integral of a function <span class="math notranslate nohighlight">\(f(x)\)</span> from <span class="math notranslate nohighlight">\(x = a\)</span> to <span class="math notranslate nohighlight">\(x = b\)</span> can be approximated by the sum of the area of <span class="math notranslate nohighlight">\(n\)</span> geometric figures with the width <span class="math notranslate nohighlight">\(h = \frac{b-a}{n}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) dx \approx \frac{h}{3} \left( f(a) + f(b) + 2\sum_{k = 1}^{\frac{n}{2} - 1} f(x_{2k}) + 4\sum_{k=1}^{\frac{n}{2}} f(x_{2k-1}) \right)\]</div>
</div>
<p>We can implement the method like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simpsons</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">+=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">h</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise</p>
<p>Study the code above and try to identify the terms in the definition of Simpson’s method.</p>
</div>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/simspsons_3.png?raw=true" width="500"/>
<img src="https://github.com/andreasdh/programmering-i-kjemi/blob/master/docs/bilder_engelsk/simpsons_10.png?raw=true" width="500"/>
<p>The methods we now have looked at are based on the same concept, namely approximation of the area under a graph using geometric shapes with a rectangular base and a polynomial of degree <span class="math notranslate nohighlight">\(n\)</span> as the top part. Since the principle is the same, we call them a <em>family</em> of methods (nice, right?). This family is called <em>Newton-Cotes</em>. This means that, for example, the trapezoidal rule is called a Newton-Cotes method of the first degree, while Simpson’s method is a Newton-Cotes method of the second degree. There are many other methods and families within numerical integration, but we will leave those for now.</p>
</section>
<section id="using-libraries-to-compute-integrals">
<h2>Using libraries to compute integrals<a class="headerlink" href="#using-libraries-to-compute-integrals" title="Permalink to this heading">#</a></h2>
<p>“Have no one else implemented these methods”, you might have thought when sweating to implement the trapezoidal rule previously. The answer is “yes, they have!”. And we can use them by importing the library <em>scipy</em> (<em>scientific python</em>). Then why did you need to do it? There are two main reasons:</p>
<ol class="arabic simple">
<li><p>Pedagogical reasons: By implementing numerical methods, you get a better grasp of how the methods work. Intepreting and writing code gives you insight into the mathematical principles behind each method, which might improve your understanding of what it means to integrate something.</p></li>
<li><p>Creative and technical reasons: Self-implemented code can be altered in every way you see fit. Do you want an error message if your algorithm uses too many iterations? Or do you want your method to be a combination of different algorithms? When making a code of your own, you have total control (at least in principle) of what you make. You can be creative and solve problems in a way tailored for your specific needs.</p></li>
</ol>
<p>Despite the benefits of making our own code, in our day to day lives it is useful to be able to utilize code that we know works. Therefore, we show you how to integrate a function using the trapezoidal rule, simpson’s rule and Gaussian quadrature. We haven’t introduced the last method, but you might learn to use it nonetheless (it’ great, we promise!).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Integration</span>
<span class="n">trapezoid</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="c1"># Needs arrays as parameter</span>
<span class="n">simpsons</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Needs arrays as parameter</span>
<span class="n">gaussian_quadrature</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># Needs a function as parameter</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trapezoidal rule:&quot;</span><span class="p">,</span><span class="n">trapes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simpson&#39;s method:&quot;</span><span class="p">,</span><span class="n">simpsons</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gaussian quadrature:&quot;</span><span class="p">,</span><span class="n">gaussian_quadrature</span><span class="p">)</span> <span class="c1"># Prints both the answer and the absolute error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trapesmetoden: 151.2501565629694
Simpsons metode: 151.25000015671972
Gauss kvadratur: (151.25, 1.6959623319719519e-12)
</pre></div>
</div>
</div>
</div>
<section id="multiple-integration">
<h3>Multiple integration<a class="headerlink" href="#multiple-integration" title="Permalink to this heading">#</a></h3>
<p>We can also evaluate double and triple integrals with functions from the scipy library. Let’s solve the following integrals with the functions <em>dblquad</em> (for double integrals) and <em>tplquad</em> (for triple integrals):</p>
<div class="math notranslate nohighlight">
\[\int_0^{\frac{\pi}{2}} \int_{-1}^1  x \sin(y) - y e^x \ dx dy\]</div>
<div class="math notranslate nohighlight">
\[\int_0^{3} \int_{0}^2  \int_{0}^1 xyz \ dx dy dz\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span>

<span class="n">numerical_double</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">dblquad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">numerical_triple</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">tplquad</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">analytical_double</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">analytical_triple</span> <span class="o">=</span> <span class="mi">9</span><span class="o">/</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Numerical value of the double integral: </span><span class="si">{</span><span class="n">numerical_double</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Analytical value of the double integral:: </span><span class="si">{</span><span class="n">analytical_double</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Numerical value of the triple integral:: </span><span class="si">{</span><span class="n">numerical_triple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Analytical value of the triple integral:: </span><span class="si">{</span><span class="n">analytical_triple</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Numerical value of the double integral: -2.899692718238082
Analytical value of the double integral:: -2.8996927182380823
Numerical value of the triple integral:: 4.5
Analytical value of the triple integral:: 4.5
</pre></div>
</div>
</div>
</div>
<p>Look at how precise the methods are! Quite great, right?</p>
</section>
</section>
<section id="symbolic-integration">
<h2>Symbolic integration<a class="headerlink" href="#symbolic-integration" title="Permalink to this heading">#</a></h2>
<p>In some instances, the integrals we need to compute might be solved symbolically. We can do this by hand, or we can do it by using the library <em>sympy</em> (<em>symbolic python</em>). This is a very “black box” solution, and you don’t get any insight into what is happening, but it is a useful tool for checking your math or comparing numerical methods on difficult integrals. Below is an example of indefinite integration followed by an example of definite integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="c1"># Alternative to these two lines: x, y = symbols(&quot;x y&quot;)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle x^{4} - \cos{\left(x \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span> <span class="c1"># oo means infinity, and -oo to oo are the integration limits</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{\sqrt{2} \sqrt{\pi}}{2}\]</div>
</div>
</div>
</section>
<section id="concluding-remarks">
<h2>Concluding remarks<a class="headerlink" href="#concluding-remarks" title="Permalink to this heading">#</a></h2>
<p>We hope you had some fun with numerical integration, and that you learned something! Here are some pointers on what you should know after working with this material:</p>
</section>
<section id="videos">
<h2>Videos<a class="headerlink" href="#videos" title="Permalink to this heading">#</a></h2>
<p>You can use the videos below (in Norwegian) to learn or repeat what you learned about numerical integration:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
Numerical integration</label><div class="sd-tab-content docutils">
<iframe width="850" height="450" src="https://www.youtube.com/embed/XHahL9ER2wA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
Different methods for numerical integration</label><div class="sd-tab-content docutils">
<iframe width="850" height="450" src="https://www.youtube.com/embed/KOL92Jxp_Yk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/numerical_calculus"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../numerical_calculus.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Numerical calculus</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-integral-really">What is the integral, really?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rectangle-methods">Rectangle methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-the-rectangle-methods">Implementing the rectangle methods</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-trapezoidal-rule">The Trapezoidal rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpson-s-method">Simpson’s method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-libraries-to-compute-integrals">Using libraries to compute integrals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-integration">Multiple integration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-integration">Symbolic integration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concluding-remarks">Concluding remarks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videos">Videos</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Curious minds
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>